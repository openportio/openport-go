name: Docker Compose

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:

  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Docker Setup Compose
      uses: docker/setup-compose-action@v1.2.0

    - name: Docker compose tests run
      # You may pin to the exact commit or the version.
      # uses: cloudposse/github-action-docker-compose-test-run@885bb157bac4a43ff80c24bc4df852635e348a03
      uses: cloudposse/github-action-docker-compose-test-run@0.2.0
      with:
        file: docker-compose.yaml
        service: client_tests
        entrypoint: ""
        command: sh -c "gotestsum --format standard-verbose --junitfile /apps/go/test-results/report.xml apps/openport/*.go"
